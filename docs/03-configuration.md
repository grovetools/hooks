# Configuring Grove Hooks

`grove-hooks` integrates with other tools by defining commands to be executed at specific points in an AI agent's lifecycle. Configuration is managed through files generated by other tools and via environment variables.

## Primary Integration: Claude Code

The primary configuration is for integration with the Claude Code CLI. This is automated by the `grove-hooks install` command.

```bash
# In your project's root directory
grove-hooks install
```

This command creates or updates the `.claude/settings.local.json` file. This file directs Claude Code to execute `grove-hooks` commands when certain events occur. Existing settings in the file are preserved.

### Example `.claude/settings.local.json`

After running `install`, the configuration file will contain a `hooks` section:

```json
{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": ".*",
        "hooks": [
          {
            "type": "command",
            "command": "grove-hooks pretooluse"
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": ".*",
        "hooks": [
          {
            "type": "command",
            "command": "grove-hooks posttooluse"
          }
        ]
      }
    ],
    "Notification": [
      {
        "matcher": ".*",
        "hooks": [
          {
            "type": "command",
            "command": "grove-hooks notification"
          }
        ]
      }
    ],
    "Stop": [
      {
        "matcher": ".*",
        "hooks": [
          {
            "type": "command",
            "command": "grove-hooks stop"
          }
        ]
      }
    ],
    "SubagentStop": [
      {
        "matcher": ".*",
        "hooks": [
          {
            "type": "command",
            "command": "grove-hooks subagentstop"
          }
        ]
      }
    ]
  }
}
```

## Hook Triggers

`grove-hooks` responds to lifecycle events triggered by the host application (e.g., Claude Code). Each hook corresponds to a stage of an agent session.

-   **`PreToolUse`**: Executes before an agent uses a tool. This hook records the tool name and its parameters.
-   **`PostToolUse`**: Executes after a tool has been used. This hook records the tool's output, execution duration, and success or failure status.
-   **`Notification`**: Triggers when the agent generates a notification. This hook can be used to send system-level desktop notifications.
-   **`Stop`**: Triggers when a session ends. This hook finalizes the session's status in the database and can execute repository-specific commands.
-   **`SubagentStop`**: Triggers when a sub-agent completes a delegated task.

## Environment Variables

-   **`GROVE_HOOKS_DB_PATH`**: Overrides the default path to the SQLite database. The default is `~/.local/share/grove-hooks/state.db`. This is used for isolating data in testing environments.
-   **`GROVE_DEBUG`**: If set to a non-empty string, enables verbose debug logging to standard output.